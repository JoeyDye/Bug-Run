"use strict";!function(){var e={},n=[];function t(t){if(e[t])return e[t];var i=new Image;i.onload=function(){e[t]=i,a()&&n.forEach(function(e){e()})},e[t]=!1,i.src=t}function a(){var n=!0;for(var t in e)e.hasOwnProperty(t)&&!e[t]&&(n=!1);return n}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)},get:function(n){return e[n]},onReady:function(e){n.push(e)},isReady:a}}();var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}$("#myModal").modal("show");var Enemy=function(){function e(n,t){_classCallCheck(this,e),this.x=n,this.y=t,this.speed=Math.floor(5*Math.random()+10),this.sprite="images/enemy-bug.png"}return _createClass(e,[{key:"update",value:function(e){this.speed}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}},{key:"checkCollisions",value:function(){this.x>player.x-65&&this.x<player.x+80&&this.y>=player.y-70&&this.y<player.y+65&&player.resetPlayer()}},{key:"reset",value:function(){this.x>515&&(this.x=-200)}},{key:"moveEnemy",value:function(e){var n=setInterval(function(){!0===player.winGame&&clearInterval(n),e.checkCollisions(),e.update(),e.reset(),e.x+=e.speed},75)}}]),e}(),Player=function(){function e(){_classCallCheck(this,e),this.x=200,this.y=380,this.speed=30,this.sprite,this.winGame=!1}return _createClass(e,[{key:"update",value:function(e){this.speed}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}},{key:"resetPlayer",value:function(){this.x=200,this.y=420}},{key:"win",value:function(){var e=this;this.winGame=!0;var n=document.querySelector(".win-text");n.innerHTML="You Win!!!",star.y=-200,setTimeout(function(){e.resetPlayer(),startEnemies(),n.innerHTML="",star.y=-5,e.winGame=!1},3e3)}},{key:"handleInput",value:function(e){if(!0!==player.winGame)switch(this.x>star.x-70&&this.x<star.x+60&&this.y>=star.y-50&&this.y<star.y+50&&this.win(),this.update(),e){case"up":this.y>-5&&(this.y-=this.speed);break;case"down":this.y<canvas.height-175&&(this.y+=this.speed);break;case"right":this.x<canvas.width-100&&(this.x+=this.speed);break;case"left":this.x>-10&&(this.x-=this.speed)}}}]),e}(),Star=function(){function e(){_classCallCheck(this,e),this.x=205,this.y=-5,this.sprite="images/star.png"}return _createClass(e,[{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}}]),e}(),selectGirl=document.querySelector("#girl"),selectBoy=document.querySelector("#boy"),setPlayerGirl=function(){player.sprite="images/char-cat-girl.png",$("#myModal").modal("hide"),Engine(window)},setPlayerBoy=function(){player.sprite="images/char-boy.png",$("#myModal").modal("hide"),Engine(window)};selectGirl.addEventListener("click",setPlayerGirl),selectBoy.addEventListener("click",setPlayerBoy);var player=new Player,star=new Star,enemy1=new Enemy(-10,60),enemy2=new Enemy(-10,140),enemy3=new Enemy(-10,220),enemy4=new Enemy(-500,60),enemy5=new Enemy(-500,140),enemy6=new Enemy(-500,220),allEnemies=[enemy1,enemy2,enemy3,enemy4,enemy5,enemy6],startEnemies=function(){var e=!0,n=!1,t=void 0;try{for(var a,i=allEnemies[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var s=a.value;s.moveEnemy(s)}}catch(e){n=!0,t=e}finally{try{!e&&i.return&&i.return()}finally{if(n)throw t}}};startEnemies(),document.addEventListener("keyup",function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])});var Engine=function(e){var n,t=e.document,a=e.window,i=t.createElement("canvas"),s=i.getContext("2d");function r(){var e,t=Date.now();e=(t-n)/1e3,allEnemies.forEach(function(n){n.update(e)}),player.update(),function(){var e,n,t=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png","images/grass-block.png"];for(s.clearRect(0,0,i.width,i.height),e=0;e<6;e++)for(n=0;n<5;n++)s.drawImage(Resources.get(t[e]),101*n,83*e);allEnemies.forEach(function(e){e.render()}),player.render(),star.render()}(),n=t,a.requestAnimationFrame(r)}i.width=505,i.height=606,t.body.appendChild(i),Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-boy.png","images/char-cat-girl.png","images/star.png"]),Resources.onReady(function(){n=Date.now(),r()}),e.ctx=s,e.canvas=i};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc291cmNlcy5qcyIsImFwcC5qcyIsImVuZ2luZS5qcyJdLCJuYW1lcyI6WyJyZXNvdXJjZUNhY2hlIiwicmVhZHlDYWxsYmFja3MiLCJfbG9hZCIsInVybCIsImltZyIsIkltYWdlIiwib25sb2FkIiwiaXNSZWFkeSIsImZvckVhY2giLCJmdW5jIiwic3JjIiwicmVhZHkiLCJrIiwiaGFzT3duUHJvcGVydHkiLCJ3aW5kb3ciLCJSZXNvdXJjZXMiLCJsb2FkIiwidXJsT3JBcnIiLCJBcnJheSIsImdldCIsIm9uUmVhZHkiLCJwdXNoIiwiJCIsIm1vZGFsIiwiRW5lbXkiLCJ4IiwieSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJzcGVlZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInNwcml0ZSIsImR0IiwiY3R4IiwiZHJhd0ltYWdlIiwicGxheWVyIiwicmVzZXRQbGF5ZXIiLCJjaGFyIiwiZW5lbXlJbnRlcnZhbCIsInNldEludGVydmFsIiwid2luR2FtZSIsImNsZWFySW50ZXJ2YWwiLCJjaGVja0NvbGxpc2lvbnMiLCJ1cGRhdGUiLCJyZXNldCIsIlBsYXllciIsIl90aGlzIiwid2luTWVzc2FnZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsInN0YXIiLCJzZXRUaW1lb3V0Iiwic3RhcnRFbmVtaWVzIiwia2V5Y29kZSIsIndpbiIsImNhbnZhcyIsImhlaWdodCIsIndpZHRoIiwiU3RhciIsInNlbGVjdEdpcmwiLCJzZWxlY3RCb3kiLCJzZXRQbGF5ZXJHaXJsIiwiRW5naW5lIiwic2V0UGxheWVyQm95IiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuZW15MSIsImVuZW15MiIsImVuZW15MyIsImVuZW15NCIsImVuZW15NSIsImVuZW15NiIsImFsbEVuZW1pZXMiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsInVuZGVmaW5lZCIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsInZhbHVlIiwibW92ZUVuZW15IiwiZXJyIiwicmV0dXJuIiwiZSIsImhhbmRsZUlucHV0IiwiMzciLCIzOCIsIjM5IiwiNDAiLCJrZXlDb2RlIiwiZ2xvYmFsIiwibGFzdFRpbWUiLCJkb2MiLCJjcmVhdGVFbGVtZW50IiwiZ2V0Q29udGV4dCIsIm1haW4iLCJub3ciLCJEYXRlIiwiZW5lbXkiLCJyb3ciLCJjb2wiLCJyb3dJbWFnZXMiLCJjbGVhclJlY3QiLCJyZW5kZXIiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiXSwibWFwcGluZ3MiOiJjQU1BLFdBQ0UsSUFBSUEsS0FFQUMsS0EyQkosU0FBU0MsRUFBTUMsR0FDYixHQUFHSCxFQUFjRyxHQUtmLE9BQU9ILEVBQWNHLEdBS3JCLElBQUlDLEVBQU0sSUFBSUMsTUFDZEQsRUFBSUUsT0FBUyxXQUtYTixFQUFjRyxHQUFPQyxFQUtsQkcsS0FDRE4sRUFBZU8sUUFBUSxTQUFTQyxHQUFRQSxPQVE1Q1QsRUFBY0csSUFBTyxFQUNyQkMsRUFBSU0sSUFBTVAsRUFlZCxTQUFTSSxJQUNQLElBQUlJLEdBQVEsRUFDWixJQUFJLElBQUlDLEtBQUtaLEVBQ1JBLEVBQWNhLGVBQWVELEtBQzNCWixFQUFjWSxLQUNqQkQsR0FBUSxHQUdaLE9BQU9BLEVBYVRHLE9BQU9DLFdBQ0xDLEtBMUZGLFNBQWNDLEdBQ1RBLGFBQW9CQyxNQUtyQkQsRUFBU1QsUUFBUSxTQUFTTCxHQUN4QkQsRUFBTUMsS0FPUkQsRUFBTWUsSUE2RVJFLElBOUJGLFNBQWFoQixHQUNYLE9BQU9ILEVBQWNHLElBOEJyQmlCLFFBVkYsU0FBaUJYLEdBQ2ZSLEVBQWVvQixLQUFLWixJQVVwQkYsUUFBU0EsR0F0R2IsbVhDTEFlLEVBQUUsWUFBWUMsTUFBTSxZQVdkQyxpQkFDSixTQUFBQSxFQUFZQyxFQUFHQyxHQUFHQyxnQkFBQUMsS0FBQUosR0FDaEJJLEtBQUtILEVBQUlB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R0FDQSx5QkFDQSx5QkFDQSx5QkFDQSx5QkFDQSx5QkFDQSwwQkFhSixJQU5BeEUsRUFBSXlFLFVBQVUsRUFBRSxFQUFFbEQsRUFBT0UsTUFBTUYsRUFBT0MsUUFNakM4QyxFQUFNLEVBQUdBLEVBWEYsRUFXaUJBLElBQzNCLElBQUtDLEVBQU0sRUFBR0EsRUFYSixFQVdtQkEsSUFRM0J2RSxFQUFJQyxVQUFVckIsVUFBVUksSUFBSXdGLEVBQVVGLElBQWEsSUFBTkMsRUFBaUIsR0FBTkQsR0FlNUQvQixXQUFXbEUsUUFBUSxTQUFTZ0csR0FDMUJBLEVBQU1LLFdBR1J4RSxPQUFPd0UsU0FDUHhELEtBQUt3RCxTQTVHTEEsR0FLQVosRUFBV0ssRUFLWDdDLEVBQUlxRCxzQkFBc0JULEdBL0I1QjNDLEVBQU9FLE1BQVEsSUFDZkYsRUFBT0MsT0FBUyxJQUNoQnVDLEVBQUlhLEtBQUtDLFlBQVl0RCxHQTZJckIzQyxVQUFVQyxNQUNSLHlCQUNBLHlCQUNBLHlCQUNBLHVCQUNBLHNCQUNBLDJCQUNBLG9CQUVGRCxVQUFVSyxRQWxIVixXQUVFNkUsRUFBV00sS0FBS0QsTUFDaEJELE1BcUhGTCxFQUFPN0QsSUFBTUEsRUFDYjZELEVBQU90QyxPQUFTQSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBSZXNvdXJjZXMuanNcbiAqIFRoaXMgaXMgc2ltcGx5IGFuIGltYWdlIGxvYWRpbmcgdXRpbGl0eS4gSXQgZWFzZXMgdGhlIHByb2Nlc3Mgb2YgbG9hZGluZ1xuICogaW1hZ2UgZmlsZXMgc28gdGhhdCB0aGV5IGNhbiBiZSB1c2VkIHdpdGhpbiB5b3VyIGdhbWUuIEl0IGFsc28gaW5jbHVkZXNcbiAqIGEgc2ltcGxlIFwiY2FjaGluZ1wiIGxheWVyIHNvIGl0IHdpbGwgcmV1c2UgY2FjaGVkIGltYWdlcyBpZiB5b3UgYXR0ZW1wdFxuICogdG8gbG9hZCB0aGUgc2FtZSBpbWFnZSBtdWx0aXBsZSB0aW1lcy5cbiAqL1xuKGZ1bmN0aW9uKCkge1xuICB2YXIgcmVzb3VyY2VDYWNoZSA9IHt9O1xuICB2YXIgbG9hZGluZyA9IFtdO1xuICB2YXIgcmVhZHlDYWxsYmFja3MgPSBbXTtcblxuICAvKiBUaGlzIGlzIHRoZSBwdWJsaWNseSBhY2Nlc3NpYmxlIGltYWdlIGxvYWRpbmcgZnVuY3Rpb24uIEl0IGFjY2VwdHNcbiAgICAqIGFuIGFycmF5IG9mIHN0cmluZ3MgcG9pbnRpbmcgdG8gaW1hZ2UgZmlsZXMgb3IgYSBzdHJpbmcgZm9yIGEgc2luZ2xlXG4gICAgKiBpbWFnZS4gSXQgd2lsbCB0aGVuIGNhbGwgb3VyIHByaXZhdGUgaW1hZ2UgbG9hZGluZyBmdW5jdGlvbiBhY2NvcmRpbmdseS5cbiAgICAqL1xuICBmdW5jdGlvbiBsb2FkKHVybE9yQXJyKSB7XG4gICAgaWYodXJsT3JBcnIgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgLyogSWYgdGhlIGRldmVsb3BlciBwYXNzZWQgaW4gYW4gYXJyYXkgb2YgaW1hZ2VzXG4gICAgICAgICogbG9vcCB0aHJvdWdoIGVhY2ggdmFsdWUgYW5kIGNhbGwgb3VyIGltYWdlXG4gICAgICAgICogbG9hZGVyIG9uIHRoYXQgaW1hZ2UgZmlsZVxuICAgICAgICAqL1xuICAgICAgdXJsT3JBcnIuZm9yRWFjaChmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgX2xvYWQodXJsKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvKiBUaGUgZGV2ZWxvcGVyIGRpZCBub3QgcGFzcyBhbiBhcnJheSB0byB0aGlzIGZ1bmN0aW9uLFxuICAgICAgICAqIGFzc3VtZSB0aGUgdmFsdWUgaXMgYSBzdHJpbmcgYW5kIGNhbGwgb3VyIGltYWdlIGxvYWRlclxuICAgICAgICAqIGRpcmVjdGx5LlxuICAgICAgICAqL1xuICAgICAgX2xvYWQodXJsT3JBcnIpO1xuICAgIH1cbiAgfVxuXG4gIC8qIFRoaXMgaXMgb3VyIHByaXZhdGUgaW1hZ2UgbG9hZGVyIGZ1bmN0aW9uLCBpdCBpc1xuICAgICogY2FsbGVkIGJ5IHRoZSBwdWJsaWMgaW1hZ2UgbG9hZGVyIGZ1bmN0aW9uLlxuICAgICovXG4gIGZ1bmN0aW9uIF9sb2FkKHVybCkge1xuICAgIGlmKHJlc291cmNlQ2FjaGVbdXJsXSkge1xuICAgICAgLyogSWYgdGhpcyBVUkwgaGFzIGJlZW4gcHJldmlvdXNseSBsb2FkZWQgaXQgd2lsbCBleGlzdCB3aXRoaW5cbiAgICAgICAgKiBvdXIgcmVzb3VyY2VDYWNoZSBhcnJheS4gSnVzdCByZXR1cm4gdGhhdCBpbWFnZSByYXRoZXJcbiAgICAgICAgKiByZS1sb2FkaW5nIHRoZSBpbWFnZS5cbiAgICAgICAgKi9cbiAgICAgIHJldHVybiByZXNvdXJjZUNhY2hlW3VybF07XG4gICAgfSBlbHNlIHtcbiAgICAvKiBUaGlzIFVSTCBoYXMgbm90IGJlZW4gcHJldmlvdXNseSBsb2FkZWQgYW5kIGlzIG5vdCBwcmVzZW50XG4gICAgICAqIHdpdGhpbiBvdXIgY2FjaGU7IHdlJ2xsIG5lZWQgdG8gbG9hZCB0aGlzIGltYWdlLlxuICAgICAgKi9cbiAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLyogT25jZSBvdXIgaW1hZ2UgaGFzIHByb3Blcmx5IGxvYWRlZCwgYWRkIGl0IHRvIG91ciBjYWNoZVxuICAgICAgICAgICogc28gdGhhdCB3ZSBjYW4gc2ltcGx5IHJldHVybiB0aGlzIGltYWdlIGlmIHRoZSBkZXZlbG9wZXJcbiAgICAgICAgICAqIGF0dGVtcHRzIHRvIGxvYWQgdGhpcyBmaWxlIGluIHRoZSBmdXR1cmUuXG4gICAgICAgICAgKi9cbiAgICAgICAgcmVzb3VyY2VDYWNoZVt1cmxdID0gaW1nO1xuXG4gICAgICAgIC8qIE9uY2UgdGhlIGltYWdlIGlzIGFjdHVhbGx5IGxvYWRlZCBhbmQgcHJvcGVybHkgY2FjaGVkLFxuICAgICAgICAgICogY2FsbCBhbGwgb2YgdGhlIG9uUmVhZHkoKSBjYWxsYmFja3Mgd2UgaGF2ZSBkZWZpbmVkLlxuICAgICAgICAgICovXG4gICAgICAgIGlmKGlzUmVhZHkoKSkge1xuICAgICAgICAgIHJlYWR5Q2FsbGJhY2tzLmZvckVhY2goZnVuY3Rpb24oZnVuYykgeyBmdW5jKCk7IH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBTZXQgdGhlIGluaXRpYWwgY2FjaGUgdmFsdWUgdG8gZmFsc2UsIHRoaXMgd2lsbCBjaGFuZ2Ugd2hlblxuICAgICAgICAqIHRoZSBpbWFnZSdzIG9ubG9hZCBldmVudCBoYW5kbGVyIGlzIGNhbGxlZC4gRmluYWxseSwgcG9pbnRcbiAgICAgICAgKiB0aGUgaW1hZ2UncyBzcmMgYXR0cmlidXRlIHRvIHRoZSBwYXNzZWQgaW4gVVJMLlxuICAgICAgICAqL1xuICAgICAgcmVzb3VyY2VDYWNoZVt1cmxdID0gZmFsc2U7XG4gICAgICBpbWcuc3JjID0gdXJsO1xuICAgIH1cbn1cblxuICAvKiBUaGlzIGlzIHVzZWQgYnkgZGV2ZWxvcGVycyB0byBncmFiIHJlZmVyZW5jZXMgdG8gaW1hZ2VzIHRoZXkga25vd1xuICAgICogaGF2ZSBiZWVuIHByZXZpb3VzbHkgbG9hZGVkLiBJZiBhbiBpbWFnZSBpcyBjYWNoZWQsIHRoaXMgZnVuY3Rpb25zXG4gICAgKiB0aGUgc2FtZSBhcyBjYWxsaW5nIGxvYWQoKSBvbiB0aGF0IFVSTC5cbiAgICAqL1xuICBmdW5jdGlvbiBnZXQodXJsKSB7XG4gICAgcmV0dXJuIHJlc291cmNlQ2FjaGVbdXJsXTtcbiAgfVxuXG4gIC8qIFRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyBpZiBhbGwgb2YgdGhlIGltYWdlcyB0aGF0IGhhdmUgYmVlbiByZXF1ZXN0ZWRcbiAgICAqIGZvciBsb2FkaW5nIGhhdmUgaW4gZmFjdCBiZWVuIHByb3Blcmx5IGxvYWRlZC5cbiAgICAqL1xuICBmdW5jdGlvbiBpc1JlYWR5KCkge1xuICAgIHZhciByZWFkeSA9IHRydWU7XG4gICAgZm9yKHZhciBrIGluIHJlc291cmNlQ2FjaGUpIHtcbiAgICAgIGlmKHJlc291cmNlQ2FjaGUuaGFzT3duUHJvcGVydHkoaykgJiZcbiAgICAgICAgICAhcmVzb3VyY2VDYWNoZVtrXSkge1xuICAgICAgICByZWFkeSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVhZHk7XG4gIH1cblxuICAvKiBUaGlzIGZ1bmN0aW9uIHdpbGwgYWRkIGEgZnVuY3Rpb24gdG8gdGhlIGNhbGxiYWNrIHN0YWNrIHRoYXQgaXMgY2FsbGVkXG4gICAgKiB3aGVuIGFsbCByZXF1ZXN0ZWQgaW1hZ2VzIGFyZSBwcm9wZXJseSBsb2FkZWQuXG4gICAgKi9cbiAgZnVuY3Rpb24gb25SZWFkeShmdW5jKSB7XG4gICAgcmVhZHlDYWxsYmFja3MucHVzaChmdW5jKTtcbiAgfVxuXG4gIC8qIFRoaXMgb2JqZWN0IGRlZmluZXMgdGhlIHB1YmxpY2x5IGFjY2Vzc2libGUgZnVuY3Rpb25zIGF2YWlsYWJsZSB0b1xuICAgICogZGV2ZWxvcGVycyBieSBjcmVhdGluZyBhIGdsb2JhbCBSZXNvdXJjZXMgb2JqZWN0LlxuICAgICovXG4gIHdpbmRvdy5SZXNvdXJjZXMgPSB7XG4gICAgbG9hZDogbG9hZCxcbiAgICBnZXQ6IGdldCxcbiAgICBvblJlYWR5OiBvblJlYWR5LFxuICAgIGlzUmVhZHk6IGlzUmVhZHlcbiAgfTtcbn0pKCk7XG4iLCIvKiogQGRlc2NyaXB0aW9uIE9wZW5zIGNoYXJhY3RlciBzZWxlY3QgbW9kYWwgb24gbG9hZCAqL1xuJCgnI215TW9kYWwnKS5tb2RhbCgnc2hvdycpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQGRlc2NyaXB0aW9uIEVuZW1pZXMgb3VyIHBsYXllciBtdXN0IGF2b2lkLiBJbmNsdWRlcyBwcm9wZXJ0aWVzIGZvciB4IGFuZCB5IGNvb3JkaW5hdGVzLFxuICogc3BlZWQsIGFuZCBzcHJpdGUgaW1hZ2UuIEFsc28sIGluY2x1ZGVzIG1ldGhvZHMgZm9yIHVwZGF0aW5nLCByZW5kZXJpbmcsIGNoZWNraW5nIGNvbGxpc2lvbnNcbiAqIHJlc2V0aW5nLCBhbmQgbW92aW5nIHRoZSBlbmVteSBhY3Jvc3MgdGhlIHNjcmVlbi4gVXNpbmcgYSBjb25zdHJ1Y3RvciBhbGxvd3MgZm9yIHRoZSBjcmVhdGlvblxuICogb2YgbXV0aXBsZSBlbmVteSBpbnN0YW5jZXMuXG4gKiBAcGFyYW0geyBudW1iZXIgfSB4IC0geCBjb29yZGluYXRlXG4gKiBAcGFyYW0geyBudW1iZXIgfSB5IC0geSBjb29yZGluYXRlXG4gKi9cbmNsYXNzIEVuZW15IHtcbiAgY29uc3RydWN0b3IoeCwgeSkge1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICAvLyBHaXZlcyBlYWNoIGVuZW15IGEgcmFuZG9tIHNwZWVkXG4gICAgdGhpcy5zcGVlZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxNSAtIDEwKSArIDEwKTtcbiAgICB0aGlzLnNwcml0ZSA9ICdpbWFnZXMvZW5lbXktYnVnLnBuZyc7XG4gIH1cblxuICAvKiogQGRlc2NyaXB0aW9uIE11bHRpcGxpZXMgYW55IG1vdmVtZW50IGJ5IHRoZSBkdCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHRoZSBnYW1lIHJ1bnMgYXQgdGhlIHNhbWVcbiAgICogc3BlZWQgZm9yIGFsbCBjb21wdXRlcnMuXG4gICAqIEBwYXJhbSB7IG51bWJlciB9IGR0ID0gZGVsdGEgdGltZVxuICAgKi9cbiAgdXBkYXRlKGR0KSB7XG4gICAgdGhpcy5zcGVlZCAqIGR0O1xuICB9XG5cbiAgLyoqIEBkZXNjcmlwdGlvbiBEcmF3cyBlbmVteSBvbiBzY3JlZW4gKi9cbiAgcmVuZGVyKCkge1xuICAgIGN0eC5kcmF3SW1hZ2UoUmVzb3VyY2VzLmdldCh0aGlzLnNwcml0ZSksIHRoaXMueCwgdGhpcy55KTtcbiAgfVxuXG4gIC8qKiBAZGVzY3JpcHRpb24gQ2hlY2tzIGZvciBlbmVteSBwbGF5ZXIgY29sbGlzaW9ucyBhbmQgcmVzdGFydCBwbGF5ZXIgb24gY29sbGlzaW9uICovXG4gIGNoZWNrQ29sbGlzaW9ucygpIHtcbiAgICBpZiAodGhpcy54ID4gKHBsYXllci54IC0gNjUpICYmIHRoaXMueCA8IHBsYXllci54ICsgODAgJiYgdGhpcy55ID49IChwbGF5ZXIueSAtIDcwKSAmJiB0aGlzLnkgPCBwbGF5ZXIueSArIDY1KSB7XG4gICAgICBwbGF5ZXIucmVzZXRQbGF5ZXIoKTtcbiAgICB9XG4gIH1cblxuICAvKiogQGRlc2NyaXB0aW9uIHJlc2V0cyBlbmVteSBwb3NpdGlvbiBpZiBnb2VzIG9mIHNjcmVlbiAqL1xuICByZXNldCgpIHtcbiAgICBpZiAodGhpcy54ID4gNTE1KSB7XG4gICAgICB0aGlzLnggPSAtMjAwO31cbiAgfVxuXG4gIC8qKiBAZGVzY3JpcHRpb24gTW92ZXMgZW5lbXkgYWNyb3NzIHNjcmVlbiwgc3RvcHMgZW5lbWllcyBpZiBnYW1lIGhhcyBiZWVuIHdvbiwgYW5kIHJlc2V0cyB0aGVcbiAgICogZW5lbXkgaWYgaXQgcmVhY2hlcyB0aGUgc2NyZWVuIGVkZ2UuXG4gICAqIEBwYXJhbSB7IHN0cmluZyB9IGNoYXIgLSBlbmVteSBpbnN0YW5jZVxuICAgKi9cbiAgbW92ZUVuZW15KGNoYXIpIHtcbiAgICBjb25zdCBlbmVteUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKHBsYXllci53aW5HYW1lID09PSB0cnVlKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoZW5lbXlJbnRlcnZhbCk7XG4gICAgICB9XG4gICAgICBjaGFyLmNoZWNrQ29sbGlzaW9ucygpO1xuICAgICAgY2hhci51cGRhdGUoKTtcbiAgICAgIGNoYXIucmVzZXQoKTtcbiAgICAgIGNoYXIueCArPSBjaGFyLnNwZWVkO1xuICAgIH0sIDc1KTt9XG59IC8vIEVuZCBvZiBFbmVteSBjbGFzc1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQGRlc2NyaXB0aW9uIFBsYXllciBjaGFyYWN0ZXIgd2hvIG11Y2ggcmVhY2ggdGhlIHN0YXIuIEluY2x1ZGVzIHByb3BlcnRpZXMgc3VjaCBhcyB4IGNvb3JkaW5hdGUsXG4gKiB5IGNvb3JkaW5hdGUsIHBsYXllciBzcGVlZCwgc3ByaXRlIGltYWdlIChiYXNlZCBvbiBwbGF5ZXIgc2VsZWN0aW9uKSwgYW5kIHdpbiBzdGF0dXMuXG4gKiBJbmNsdWRlcyBtZXRob2RzIHN1Y2ggYXMgdXBkYXRlLCByZW5kZXIsIHJlc2V0LCB3aW4sIGFuZCBoYW5kbGUgaW5wdXQgb24ga2V5cHJlc3MuXG4gKi9cblxuY2xhc3MgUGxheWVyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy54ID0gMjAwO1xuICAgIHRoaXMueSA9IDM4MDtcbiAgICB0aGlzLnNwZWVkID0gMzA7XG4gICAgdGhpcy5zcHJpdGU7XG4gICAgdGhpcy53aW5HYW1lID0gZmFsc2U7XG4gIH1cblxuICAvKiogQGRlc2NyaXB0aW9uIE11bHRpcGxpZXMgYW55IG1vdmVtZW50IGJ5IHRoZSBkdCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHRoZSBnYW1lIHJ1bnMgYXQgdGhlIHNhbWUgc3BlZWQgZm9yIGFsbCBjb21wdXRlcnMuICovXG4gIHVwZGF0ZShkdCkge1xuICAgIHRoaXMuc3BlZWQgKiBkdDtcbiAgfVxuXG4gIC8qKiBAZGVzY3JpcHRpb24gTG9hZHMgcGxheWVyIG9uIHNjcmVlbiAqL1xuICByZW5kZXIoKSB7XG4gICAgY3R4LmRyYXdJbWFnZShSZXNvdXJjZXMuZ2V0KHRoaXMuc3ByaXRlKSwgdGhpcy54LCB0aGlzLnkpO1xuICB9XG5cbiAgLyoqIEBkZXNjcmlwdGlvbiBSZXNldHMgcGxheWVyIHRvIHN0YXJ0IHBvc2l0aW9uICovXG4gIHJlc2V0UGxheWVyKCkge1xuICAgIHRoaXMueCA9IDIwMDtcbiAgICB0aGlzLnkgPSA0MjA7XG4gIH1cblxuICAvKiogQGRlc2NyaXB0aW9uIEhhbmRsZXMgZ2FtZSB3aW4gKi9cbiAgd2luKCkge1xuICAgIHRoaXMud2luR2FtZSA9IHRydWU7XG4gICAgY29uc3Qgd2luTWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53aW4tdGV4dCcpOyAvLyBEaXNwbGF5IHdpbiBtZXNzYWdlXG4gICAgd2luTWVzc2FnZS5pbm5lckhUTUwgPSAnWW91IFdpbiEhISc7XG4gICAgLy8gTW92ZSBzdGFyIG9mZiBzY3JlZW5cbiAgICBzdGFyLnkgPSAtMjAwO1xuXG4gICAgLyoqIEBkZXNjcmlwdGlvbiBSZXNldHMgZ2FtZSBhZnRlciAzIHNlY29uZHMgKi9cbiAgICBzZXRUaW1lb3V0KFxuICAgICAgKCkgPT4ge1xuICAgICAgICB0aGlzLnJlc2V0UGxheWVyKCk7XG4gICAgICAgIHN0YXJ0RW5lbWllcygpO1xuICAgICAgICB3aW5NZXNzYWdlLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBzdGFyLnkgPSAtNTtcbiAgICAgICAgdGhpcy53aW5HYW1lID0gZmFsc2U7XG4gICAgICB9LCAzMDAwKTtcbiAgfVxuXG4gIC8qKiBAZGVzY3JpcHRpb24gRW5hYmxlcyBwbGF5ZXIgbW92ZW1lbnQgb24ga2V5cHJlc3NcbiAgICogU3RvcHMgcGxheWVyIGlmIGdhbWUgaGFzIGJlZW4gd29uXG4gICAqIFJ1bnMgd2luIG1ldGhvZCBpZiBwbGF5ZXIgcmVhY2hlcyBzdGFyXG4gICAqIENoZWNrcyBrZXljb2RlLCBhbmQgbW92ZXMgcGxheWVyIGJhc2VkIG9uIGlucHV0XG4gICAqIFN0b3BzIHBsYXllciBpZiByZWFjaGVzIGVkZ2Ugb2Ygc2NyZWVuXG4gICAqIEBwYXJhbSB7IG9iamVjdCB9IGtleWNvZGUgLSBwcmVzc2VkIGtleVxuICAgKi9cbiAgaGFuZGxlSW5wdXQoa2V5Y29kZSkge1xuICAgIGlmIChwbGF5ZXIud2luR2FtZSA9PT0gdHJ1ZSkgcmV0dXJuO1xuXG4gICAgaWYgKHRoaXMueCA+IChzdGFyLnggLSA3MCkgJiYgdGhpcy54IDwgc3Rhci54ICsgNjAgJiYgdGhpcy55ID49IChzdGFyLnkgLSA1MCkgJiYgdGhpcy55IDwgc3Rhci55ICsgNTApIHtcbiAgICAgIHRoaXMud2luKCk7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlKCk7XG5cbiAgICBzd2l0Y2ggKGtleWNvZGUpIHtcbiAgICBjYXNlICd1cCc6XG4gICAgICBpZiAodGhpcy55ID4gLTUpIHtcbiAgICAgICAgdGhpcy55IC09IHRoaXMuc3BlZWQ7fVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnZG93bic6XG4gICAgICBpZiAodGhpcy55IDwgY2FudmFzLmhlaWdodCAtIDE3NSkge1xuICAgICAgICB0aGlzLnkgKz0gdGhpcy5zcGVlZDt9XG4gICAgICBicmVhaztcbiAgICBjYXNlICdyaWdodCc6XG4gICAgICBpZiAodGhpcy54IDwgY2FudmFzLndpZHRoIC0gMTAwKSB7XG4gICAgICAgIHRoaXMueCArPSB0aGlzLnNwZWVkOyB9XG4gICAgICBicmVhaztcbiAgICBjYXNlICdsZWZ0JzpcbiAgICAgIGlmICh0aGlzLnggPiAtMTApIHtcbiAgICAgICAgdGhpcy54IC09IHRoaXMuc3BlZWQ7fVxuICAgIH1cbiAgfVxufSAvLyBFbmQgb2YgUGxheWVyIGNsYXNzXG5cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBkZXNjcmlwdGlvbiBTdGFyIHRoZSBwbGF5ZXIgbXVjaCByZWFjaCB0byB3aW4uIFByb3BlcnRpZXMgaW5jbHVkZSB4IGNvb3JkaW5hdGUsIHkgY29vcmRpbmF0ZSwgYW5kXG4gKiBzcHJpdGUgaW1hZ2UuIE1ldGhvZHMgaW5jbHVkZSByZW5kZXIuXG4gKi9cbmNsYXNzIFN0YXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnggPSAyMDU7XG4gICAgdGhpcy55ID0gLTU7XG4gICAgdGhpcy5zcHJpdGUgPSAnaW1hZ2VzL3N0YXIucG5nJztcbiAgfVxuXG4gIC8qKiBAZGVzY3JpcHRpb24gTG9hZHMgc3RhciBvbiBzY3JlZW4gKi9cbiAgcmVuZGVyKCkge1xuICAgIGN0eC5kcmF3SW1hZ2UoUmVzb3VyY2VzLmdldCh0aGlzLnNwcml0ZSksIHRoaXMueCwgdGhpcy55KTtcbiAgfVxufSAvLyBFbmQgb2YgU3RhciBjbGFzc1xuXG4vKiogQGRlc2NyaXB0aW9uIEFkZHMgZXZlbnQgbGlzdGVuZXIgdG8gbGlzdGVuIGZvciBwbGF5ZXIgc2VsZWN0aW9uLiBTdGFydCBnYW1lIG9uY2UgcGxheWVyIHNlbGVjdGVkLiAqL1xuY29uc3Qgc2VsZWN0R2lybCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnaXJsJyk7XG5jb25zdCBzZWxlY3RCb3kgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYm95Jyk7XG5cbmNvbnN0IHNldFBsYXllckdpcmwgPSAoKSA9PiB7XG4gIHBsYXllci5zcHJpdGUgPSAnaW1hZ2VzL2NoYXItY2F0LWdpcmwucG5nJztcbiAgJCgnI215TW9kYWwnKS5tb2RhbCgnaGlkZScpO1xuICBFbmdpbmUod2luZG93KTtcbn07XG5cbmNvbnN0IHNldFBsYXllckJveSA9ICgpID0+IHtcbiAgcGxheWVyLnNwcml0ZSA9ICdpbWFnZXMvY2hhci1ib3kucG5nJztcbiAgJCgnI215TW9kYWwnKS5tb2RhbCgnaGlkZScpO1xuICBFbmdpbmUod2luZG93KTtcbn07XG5cbnNlbGVjdEdpcmwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZXRQbGF5ZXJHaXJsKTtcbnNlbGVjdEJveS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNldFBsYXllckJveSk7XG5cbi8qKiBAZGVzY3JpcHRpb24gaW5zdGFudGlhdGVzIGFsbCBlbmVteSwgcGxheWVyLCBhbmQgc3RhciBvYmplY3RzLCBhbmQgcGxhY2UgYWxsIGVuZW1pZXMgaW4gYXJyYXkgY2FsbGVkIGFsbEVuZW1pZXMgKi9cbmNvbnN0IHBsYXllciA9IG5ldyBQbGF5ZXIoKTtcbmNvbnN0IHN0YXIgPSBuZXcgU3RhcigpO1xuY29uc3QgZW5lbXkxID0gbmV3IEVuZW15KC0xMCwgNjApO1xuY29uc3QgZW5lbXkyID0gbmV3IEVuZW15KC0xMCwgMTQwKTtcbmNvbnN0IGVuZW15MyA9IG5ldyBFbmVteSgtMTAsIDIyMCk7XG5jb25zdCBlbmVteTQgPSBuZXcgRW5lbXkoLTUwMCwgNjApO1xuY29uc3QgZW5lbXk1ID0gbmV3IEVuZW15KC01MDAsIDE0MCk7XG5jb25zdCBlbmVteTYgPSBuZXcgRW5lbXkoLTUwMCwgMjIwKTtcbmNvbnN0IGFsbEVuZW1pZXMgPSBbZW5lbXkxLCBlbmVteTIsIGVuZW15MywgZW5lbXk0LCBlbmVteTUsIGVuZW15Nl07XG5cbi8qKiBAZGVzY3JpcHRpb24gTW92ZXMgZW5lbWllcyBhdCB2YXJ5aW5nIHNwZWVkIGFjY3Jvc3Mgc2NyZWVuICovXG5jb25zdCBzdGFydEVuZW1pZXMgPSAoKSA9PiB7XG4gIGZvciAobGV0IGNoYXIgb2YgYWxsRW5lbWllcykge1xuICAgIGNoYXIubW92ZUVuZW15KGNoYXIpO1xuICB9XG59O1xuc3RhcnRFbmVtaWVzKCk7XG5cbi8qKiBAZGVzY3JpcHRpb24gTGlzdGVucyBmb3Iga2V5IHByZXNzZXMgYW5kIHNlbmQgdGhlIGtleXMgdG8gUGxheWVyLmhhbmRsZUlucHV0KCkgbWV0aG9kICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcbiAgdmFyIGFsbG93ZWRLZXlzID0ge1xuICAgIDM3OiAnbGVmdCcsXG4gICAgMzg6ICd1cCcsXG4gICAgMzk6ICdyaWdodCcsXG4gICAgNDA6ICdkb3duJ1xuICB9O1xuXG4gIHBsYXllci5oYW5kbGVJbnB1dChhbGxvd2VkS2V5c1tlLmtleUNvZGVdKTtcbn0pO1xuIiwiLyogRW5naW5lLmpzXG4gKiBUaGlzIGZpbGUgcHJvdmlkZXMgdGhlIGdhbWUgbG9vcCBmdW5jdGlvbmFsaXR5ICh1cGRhdGUgZW50aXRpZXMgYW5kIHJlbmRlciksXG4gKiBkcmF3cyB0aGUgaW5pdGlhbCBnYW1lIGJvYXJkIG9uIHRoZSBzY3JlZW4sIGFuZCB0aGVuIGNhbGxzIHRoZSB1cGRhdGUgYW5kXG4gKiByZW5kZXIgbWV0aG9kcyBvbiB5b3VyIHBsYXllciBhbmQgZW5lbXkgb2JqZWN0cyAoZGVmaW5lZCBpbiB5b3VyIGFwcC5qcykuXG4gKlxuICogQSBnYW1lIGVuZ2luZSB3b3JrcyBieSBkcmF3aW5nIHRoZSBlbnRpcmUgZ2FtZSBzY3JlZW4gb3ZlciBhbmQgb3Zlciwga2luZCBvZlxuICogbGlrZSBhIGZsaXBib29rIHlvdSBtYXkgaGF2ZSBjcmVhdGVkIGFzIGEga2lkLiBXaGVuIHlvdXIgcGxheWVyIG1vdmVzIGFjcm9zc1xuICogdGhlIHNjcmVlbiwgaXQgbWF5IGxvb2sgbGlrZSBqdXN0IHRoYXQgaW1hZ2UvY2hhcmFjdGVyIGlzIG1vdmluZyBvciBiZWluZ1xuICogZHJhd24gYnV0IHRoYXQgaXMgbm90IHRoZSBjYXNlLiBXaGF0J3MgcmVhbGx5IGhhcHBlbmluZyBpcyB0aGUgZW50aXJlIFwic2NlbmVcIlxuICogaXMgYmVpbmcgZHJhd24gb3ZlciBhbmQgb3ZlciwgcHJlc2VudGluZyB0aGUgaWxsdXNpb24gb2YgYW5pbWF0aW9uLlxuICpcbiAqIFRoaXMgZW5naW5lIG1ha2VzIHRoZSBjYW52YXMnIGNvbnRleHQgKGN0eCkgb2JqZWN0IGdsb2JhbGx5IGF2YWlsYWJsZSB0byBtYWtlXG4gKiB3cml0aW5nIGFwcC5qcyBhIGxpdHRsZSBzaW1wbGVyIHRvIHdvcmsgd2l0aC5cbiAqL1xuXG52YXIgRW5naW5lID0gKGZ1bmN0aW9uKGdsb2JhbCkge1xuICAvKiBQcmVkZWZpbmUgdGhlIHZhcmlhYmxlcyB3ZSdsbCBiZSB1c2luZyB3aXRoaW4gdGhpcyBzY29wZSxcbiAgICAgKiBjcmVhdGUgdGhlIGNhbnZhcyBlbGVtZW50LCBncmFiIHRoZSAyRCBjb250ZXh0IGZvciB0aGF0IGNhbnZhc1xuICAgICAqIHNldCB0aGUgY2FudmFzIGVsZW1lbnRzIGhlaWdodC93aWR0aCBhbmQgYWRkIGl0IHRvIHRoZSBET00uXG4gICAgICovXG4gIHZhciBkb2MgPSBnbG9iYWwuZG9jdW1lbnQsXG4gICAgd2luID0gZ2xvYmFsLndpbmRvdyxcbiAgICBjYW52YXMgPSBkb2MuY3JlYXRlRWxlbWVudCgnY2FudmFzJyksXG4gICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyksXG4gICAgbGFzdFRpbWU7XG5cbiAgY2FudmFzLndpZHRoID0gNTA1O1xuICBjYW52YXMuaGVpZ2h0ID0gNjA2O1xuICBkb2MuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuXG4gIC8qIFRoaXMgZnVuY3Rpb24gc2VydmVzIGFzIHRoZSBraWNrb2ZmIHBvaW50IGZvciB0aGUgZ2FtZSBsb29wIGl0c2VsZlxuICAgICogYW5kIGhhbmRsZXMgcHJvcGVybHkgY2FsbGluZyB0aGUgdXBkYXRlIGFuZCByZW5kZXIgbWV0aG9kcy5cbiAgICAqL1xuICBmdW5jdGlvbiBtYWluKCkge1xuICAgIC8qIEdldCBvdXIgdGltZSBkZWx0YSBpbmZvcm1hdGlvbiB3aGljaCBpcyByZXF1aXJlZCBpZiB5b3VyIGdhbWVcbiAgICAgICogcmVxdWlyZXMgc21vb3RoIGFuaW1hdGlvbi4gQmVjYXVzZSBldmVyeW9uZSdzIGNvbXB1dGVyIHByb2Nlc3Nlc1xuICAgICAgKiBpbnN0cnVjdGlvbnMgYXQgZGlmZmVyZW50IHNwZWVkcyB3ZSBuZWVkIGEgY29uc3RhbnQgdmFsdWUgdGhhdFxuICAgICAgKiB3b3VsZCBiZSB0aGUgc2FtZSBmb3IgZXZlcnlvbmUgKHJlZ2FyZGxlc3Mgb2YgaG93IGZhc3QgdGhlaXJcbiAgICAgICogY29tcHV0ZXIgaXMpIC0gaHVycmF5IHRpbWUhXG4gICAgICAgICAqL1xuICAgIHZhciBub3cgPSBEYXRlLm5vdygpLFxuICAgICAgZHQgPSAobm93IC0gbGFzdFRpbWUpIC8gMTAwMC4wO1xuXG4gICAgLyogQ2FsbCBvdXIgdXBkYXRlL3JlbmRlciBmdW5jdGlvbnMsIHBhc3MgYWxvbmcgdGhlIHRpbWUgZGVsdGEgdG9cbiAgICAgICogb3VyIHVwZGF0ZSBmdW5jdGlvbiBzaW5jZSBpdCBtYXkgYmUgdXNlZCBmb3Igc21vb3RoIGFuaW1hdGlvbi5cbiAgICAgICovXG4gICAgdXBkYXRlKGR0KTtcbiAgICByZW5kZXIoKTtcblxuICAgIC8qIFNldCBvdXIgbGFzdFRpbWUgdmFyaWFibGUgd2hpY2ggaXMgdXNlZCB0byBkZXRlcm1pbmUgdGhlIHRpbWUgZGVsdGFcbiAgICAgICogZm9yIHRoZSBuZXh0IHRpbWUgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQuXG4gICAgICAqL1xuICAgIGxhc3RUaW1lID0gbm93O1xuXG4gICAgLyogVXNlIHRoZSBicm93c2VyJ3MgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGZ1bmN0aW9uIHRvIGNhbGwgdGhpc1xuICAgICAgKiBmdW5jdGlvbiBhZ2FpbiBhcyBzb29uIGFzIHRoZSBicm93c2VyIGlzIGFibGUgdG8gZHJhdyBhbm90aGVyIGZyYW1lLlxuICAgICAgKi9cbiAgICB3aW4ucmVxdWVzdEFuaW1hdGlvbkZyYW1lKG1haW4pO1xuICB9XG5cbiAgLyogVGhpcyBmdW5jdGlvbiBkb2VzIHNvbWUgaW5pdGlhbCBzZXR1cCB0aGF0IHNob3VsZCBvbmx5IG9jY3VyIG9uY2UsXG4gICAgKiBwYXJ0aWN1bGFybHkgc2V0dGluZyB0aGUgbGFzdFRpbWUgdmFyaWFibGUgdGhhdCBpcyByZXF1aXJlZCBmb3IgdGhlXG4gICAgKiBnYW1lIGxvb3AuXG4gICAgKi9cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICByZXNldCgpO1xuICAgIGxhc3RUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBtYWluKCk7XG59XG5cbiAgLyogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgbWFpbiAob3VyIGdhbWUgbG9vcCkgYW5kIGl0c2VsZiBjYWxscyBhbGxcbiAgICAqIG9mIHRoZSBmdW5jdGlvbnMgd2hpY2ggbWF5IG5lZWQgdG8gdXBkYXRlIGVudGl0eSdzIGRhdGEuIEJhc2VkIG9uIGhvd1xuICAgICogeW91IGltcGxlbWVudCB5b3VyIGNvbGxpc2lvbiBkZXRlY3Rpb24gKHdoZW4gdHdvIGVudGl0aWVzIG9jY3VweSB0aGVcbiAgICAqIHNhbWUgc3BhY2UsIGZvciBpbnN0YW5jZSB3aGVuIHlvdXIgY2hhcmFjdGVyIHNob3VsZCBkaWUpLCB5b3UgbWF5IGZpbmRcbiAgICAqIHRoZSBuZWVkIHRvIGFkZCBhbiBhZGRpdGlvbmFsIGZ1bmN0aW9uIGNhbGwgaGVyZS4gRm9yIG5vdywgd2UndmUgbGVmdFxuICAgICogaXQgY29tbWVudGVkIG91dCAtIHlvdSBtYXkgb3IgbWF5IG5vdCB3YW50IHRvIGltcGxlbWVudCB0aGlzXG4gICAgKiBmdW5jdGlvbmFsaXR5IHRoaXMgd2F5ICh5b3UgY291bGQganVzdCBpbXBsZW1lbnQgY29sbGlzaW9uIGRldGVjdGlvblxuICAgICogb24gdGhlIGVudGl0aWVzIHRoZW1zZWx2ZXMgd2l0aGluIHlvdXIgYXBwLmpzIGZpbGUpLlxuICAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZShkdCwgZW5lbXkpIHtcbiAgICB1cGRhdGVFbnRpdGllcyhkdCk7XG4gIH1cblxuICAvKiBUaGlzIGlzIGNhbGxlZCBieSB0aGUgdXBkYXRlIGZ1bmN0aW9uIGFuZCBsb29wcyB0aHJvdWdoIGFsbCBvZiB0aGVcbiAgICAqIG9iamVjdHMgd2l0aGluIHlvdXIgYWxsRW5lbWllcyBhcnJheSBhcyBkZWZpbmVkIGluIGFwcC5qcyBhbmQgY2FsbHNcbiAgICAqIHRoZWlyIHVwZGF0ZSgpIG1ldGhvZHMuIEl0IHdpbGwgdGhlbiBjYWxsIHRoZSB1cGRhdGUgZnVuY3Rpb24gZm9yIHlvdXJcbiAgICAqIHBsYXllciBvYmplY3QuIFRoZXNlIHVwZGF0ZSBtZXRob2RzIHNob3VsZCBmb2N1cyBwdXJlbHkgb24gdXBkYXRpbmdcbiAgICAqIHRoZSBkYXRhL3Byb3BlcnRpZXMgcmVsYXRlZCB0byB0aGUgb2JqZWN0LiBEbyB5b3VyIGRyYXdpbmcgaW4geW91clxuICAgICogcmVuZGVyIG1ldGhvZHMuXG4gICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlRW50aXRpZXMoZHQpIHtcbiAgICBhbGxFbmVtaWVzLmZvckVhY2goZnVuY3Rpb24oZW5lbXkpIHtcbiAgICAgIGVuZW15LnVwZGF0ZShkdCk7XG4gICAgfSk7XG4gICAgcGxheWVyLnVwZGF0ZSgpO1xuICB9XG5cbiAgLyogVGhpcyBmdW5jdGlvbiBpbml0aWFsbHkgZHJhd3MgdGhlIFwiZ2FtZSBsZXZlbFwiLCBpdCB3aWxsIHRoZW4gY2FsbFxuICAgICogdGhlIHJlbmRlckVudGl0aWVzIGZ1bmN0aW9uLiBSZW1lbWJlciwgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgZXZlcnlcbiAgICAqIGdhbWUgdGljayAob3IgbG9vcCBvZiB0aGUgZ2FtZSBlbmdpbmUpIGJlY2F1c2UgdGhhdCdzIGhvdyBnYW1lcyB3b3JrIC1cbiAgICAqIHRoZXkgYXJlIGZsaXBib29rcyBjcmVhdGluZyB0aGUgaWxsdXNpb24gb2YgYW5pbWF0aW9uIGJ1dCBpbiByZWFsaXR5XG4gICAgKiB0aGV5IGFyZSBqdXN0IGRyYXdpbmcgdGhlIGVudGlyZSBzY3JlZW4gb3ZlciBhbmQgb3Zlci5cbiAgICAqL1xuICBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgLyogVGhpcyBhcnJheSBob2xkcyB0aGUgcmVsYXRpdmUgVVJMIHRvIHRoZSBpbWFnZSB1c2VkXG4gICAgICAqIGZvciB0aGF0IHBhcnRpY3VsYXIgcm93IG9mIHRoZSBnYW1lIGxldmVsLlxuICAgICAgKi9cbiAgICB2YXIgcm93SW1hZ2VzID0gW1xuICAgICAgICAnaW1hZ2VzL3dhdGVyLWJsb2NrLnBuZycsICAgLy8gVG9wIHJvdyBpcyB3YXRlclxuICAgICAgICAnaW1hZ2VzL3N0b25lLWJsb2NrLnBuZycsICAgLy8gUm93IDEgb2YgMyBvZiBzdG9uZVxuICAgICAgICAnaW1hZ2VzL3N0b25lLWJsb2NrLnBuZycsICAgLy8gUm93IDIgb2YgMyBvZiBzdG9uZVxuICAgICAgICAnaW1hZ2VzL3N0b25lLWJsb2NrLnBuZycsICAgLy8gUm93IDMgb2YgMyBvZiBzdG9uZVxuICAgICAgICAnaW1hZ2VzL2dyYXNzLWJsb2NrLnBuZycsICAgLy8gUm93IDEgb2YgMiBvZiBncmFzc1xuICAgICAgICAnaW1hZ2VzL2dyYXNzLWJsb2NrLnBuZycgICAgLy8gUm93IDIgb2YgMiBvZiBncmFzc1xuICAgICAgXSxcbiAgICAgIG51bVJvd3MgPSA2LFxuICAgICAgbnVtQ29scyA9IDUsXG4gICAgICByb3csIGNvbDtcblxuICAgIC8vIEJlZm9yZSBkcmF3aW5nLCBjbGVhciBleGlzdGluZyBjYW52YXNcbiAgICBjdHguY2xlYXJSZWN0KDAsMCxjYW52YXMud2lkdGgsY2FudmFzLmhlaWdodClcblxuICAgIC8qIExvb3AgdGhyb3VnaCB0aGUgbnVtYmVyIG9mIHJvd3MgYW5kIGNvbHVtbnMgd2UndmUgZGVmaW5lZCBhYm92ZVxuICAgICAgKiBhbmQsIHVzaW5nIHRoZSByb3dJbWFnZXMgYXJyYXksIGRyYXcgdGhlIGNvcnJlY3QgaW1hZ2UgZm9yIHRoYXRcbiAgICAgICogcG9ydGlvbiBvZiB0aGUgXCJncmlkXCJcbiAgICAgICovXG4gICAgZm9yIChyb3cgPSAwOyByb3cgPCBudW1Sb3dzOyByb3crKykge1xuICAgICAgZm9yIChjb2wgPSAwOyBjb2wgPCBudW1Db2xzOyBjb2wrKykge1xuICAgICAgICAvKiBUaGUgZHJhd0ltYWdlIGZ1bmN0aW9uIG9mIHRoZSBjYW52YXMnIGNvbnRleHQgZWxlbWVudFxuICAgICAgICAgICogcmVxdWlyZXMgMyBwYXJhbWV0ZXJzOiB0aGUgaW1hZ2UgdG8gZHJhdywgdGhlIHggY29vcmRpbmF0ZVxuICAgICAgICAgICogdG8gc3RhcnQgZHJhd2luZyBhbmQgdGhlIHkgY29vcmRpbmF0ZSB0byBzdGFydCBkcmF3aW5nLlxuICAgICAgICAgICogV2UncmUgdXNpbmcgb3VyIFJlc291cmNlcyBoZWxwZXJzIHRvIHJlZmVyIHRvIG91ciBpbWFnZXNcbiAgICAgICAgICAqIHNvIHRoYXQgd2UgZ2V0IHRoZSBiZW5lZml0cyBvZiBjYWNoaW5nIHRoZXNlIGltYWdlcywgc2luY2VcbiAgICAgICAgICAqIHdlJ3JlIHVzaW5nIHRoZW0gb3ZlciBhbmQgb3Zlci5cbiAgICAgICAgICAqL1xuICAgICAgICBjdHguZHJhd0ltYWdlKFJlc291cmNlcy5nZXQocm93SW1hZ2VzW3Jvd10pLCBjb2wgKiAxMDEsIHJvdyAqIDgzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXJFbnRpdGllcygpO1xuICB9XG5cbiAgLyogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgdGhlIHJlbmRlciBmdW5jdGlvbiBhbmQgaXMgY2FsbGVkIG9uIGVhY2ggZ2FtZVxuICAgICogdGljay4gSXRzIHB1cnBvc2UgaXMgdG8gdGhlbiBjYWxsIHRoZSByZW5kZXIgZnVuY3Rpb25zIHlvdSBoYXZlIGRlZmluZWRcbiAgICAqIG9uIHlvdXIgZW5lbXkgYW5kIHBsYXllciBlbnRpdGllcyB3aXRoaW4gYXBwLmpzXG4gICAgKi9cbiAgZnVuY3Rpb24gcmVuZGVyRW50aXRpZXMoKSB7XG4gICAgLyogTG9vcCB0aHJvdWdoIGFsbCBvZiB0aGUgb2JqZWN0cyB3aXRoaW4gdGhlIGFsbEVuZW1pZXMgYXJyYXkgYW5kIGNhbGxcbiAgICAgICogdGhlIHJlbmRlciBmdW5jdGlvbiB5b3UgaGF2ZSBkZWZpbmVkLlxuICAgICAgKi9cbiAgICBhbGxFbmVtaWVzLmZvckVhY2goZnVuY3Rpb24oZW5lbXkpIHtcbiAgICAgIGVuZW15LnJlbmRlcigpO1xuICAgIH0pO1xuXG4gICAgcGxheWVyLnJlbmRlcigpO1xuICAgIHN0YXIucmVuZGVyKCk7XG4gIH1cblxuICAvKiBUaGlzIGZ1bmN0aW9uIGRvZXMgbm90aGluZyBidXQgaXQgY291bGQgaGF2ZSBiZWVuIGEgZ29vZCBwbGFjZSB0b1xuICAgICogaGFuZGxlIGdhbWUgcmVzZXQgc3RhdGVzIC0gbWF5YmUgYSBuZXcgZ2FtZSBtZW51IG9yIGEgZ2FtZSBvdmVyIHNjcmVlblxuICAgICogdGhvc2Ugc29ydHMgb2YgdGhpbmdzLiBJdCdzIG9ubHkgY2FsbGVkIG9uY2UgYnkgdGhlIGluaXQoKSBtZXRob2QuXG4gICAgKi9cbiAgZnVuY3Rpb24gcmVzZXQoKSB7XG4gIH1cblxuICAvKiBHbyBhaGVhZCBhbmQgbG9hZCBhbGwgb2YgdGhlIGltYWdlcyB3ZSBrbm93IHdlJ3JlIGdvaW5nIHRvIG5lZWQgdG9cbiAgICAqIGRyYXcgb3VyIGdhbWUgbGV2ZWwuIFRoZW4gc2V0IGluaXQgYXMgdGhlIGNhbGxiYWNrIG1ldGhvZCwgc28gdGhhdCB3aGVuXG4gICAgKiBhbGwgb2YgdGhlc2UgaW1hZ2VzIGFyZSBwcm9wZXJseSBsb2FkZWQgb3VyIGdhbWUgd2lsbCBzdGFydC5cbiAgICAqL1xuICBSZXNvdXJjZXMubG9hZChbXG4gICAgJ2ltYWdlcy9zdG9uZS1ibG9jay5wbmcnLFxuICAgICdpbWFnZXMvd2F0ZXItYmxvY2sucG5nJyxcbiAgICAnaW1hZ2VzL2dyYXNzLWJsb2NrLnBuZycsXG4gICAgJ2ltYWdlcy9lbmVteS1idWcucG5nJyxcbiAgICAnaW1hZ2VzL2NoYXItYm95LnBuZycsXG4gICAgJ2ltYWdlcy9jaGFyLWNhdC1naXJsLnBuZycsXG4gICAgJ2ltYWdlcy9zdGFyLnBuZydcbiAgXSk7XG4gIFJlc291cmNlcy5vblJlYWR5KGluaXQpO1xuXG4gIC8qIEFzc2lnbiB0aGUgY2FudmFzJyBjb250ZXh0IG9iamVjdCB0byB0aGUgZ2xvYmFsIHZhcmlhYmxlICh0aGUgd2luZG93XG4gICAgKiBvYmplY3Qgd2hlbiBydW4gaW4gYSBicm93c2VyKSBzbyB0aGF0IGRldmVsb3BlcnMgY2FuIHVzZSBpdCBtb3JlIGVhc2lseVxuICAgICogZnJvbSB3aXRoaW4gdGhlaXIgYXBwLmpzIGZpbGVzLlxuICAgICovXG4gIGdsb2JhbC5jdHggPSBjdHg7XG4gIGdsb2JhbC5jYW52YXMgPSBjYW52YXM7XG59KTtcbiJdfQ==
